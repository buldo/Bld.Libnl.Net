using Bld.Libnl.Net.Nl80211.Enums;

namespace Bld.Libnl.Net.Nl80211.Policies;

public static partial class NlaPolicies
{
    public static Dictionary<nl80211_attrs, NlaPolicyDescription> nl80211_policy = new()
    {
        //[0] = {  .strict_start_type = NL80211_ATTR_HE_OBSS_PD },
        [nl80211_attrs.NL80211_ATTR_WIPHY] = new() {  Type = NetlinkAttributeType.NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_WIPHY_NAME] = new() { .type = NLA_NUL_STRING, .len = 20-1 },
        [nl80211_attrs.NL80211_ATTR_WIPHY_TXQ_PARAMS] = new() {  .type = NLA_NESTED },

        [nl80211_attrs.NL80211_ATTR_WIPHY_FREQ] = new() {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_WIPHY_CHANNEL_TYPE] = new() {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_WIPHY_EDMG_CHANNELS] = new() NLA_POLICY_RANGE(NLA_U8, NL80211_EDMG_CHANNELS_MIN, NL80211_EDMG_CHANNELS_MAX),
        [nl80211_attrs.NL80211_ATTR_WIPHY_EDMG_BW_CONFIG] = new() NLA_POLICY_RANGE(NLA_U8, NL80211_EDMG_BW_CONFIG_MIN, NL80211_EDMG_BW_CONFIG_MAX),

        [nl80211_attrs.NL80211_ATTR_CHANNEL_WIDTH] = new() {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_CENTER_FREQ1] = new() {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_CENTER_FREQ1_OFFSET] = new() NLA_POLICY_RANGE(NLA_U32, 0, 999),
        [nl80211_attrs.NL80211_ATTR_CENTER_FREQ2] = new() {  .type = NLA_U32 },

        [nl80211_attrs.NL80211_ATTR_WIPHY_RETRY_SHORT] = new()NLA_POLICY_MIN(NLA_U8, 1),
        [nl80211_attrs.NL80211_ATTR_WIPHY_RETRY_LONG] = new()NLA_POLICY_MIN(NLA_U8, 1),
        [nl80211_attrs.NL80211_ATTR_WIPHY_FRAG_THRESHOLD] = new() {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_WIPHY_RTS_THRESHOLD] = new() {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_WIPHY_COVERAGE_CLASS] = new() {  .type = NLA_U8 },
        [nl80211_attrs.NL80211_ATTR_WIPHY_DYN_ACK] = {  .type = NLA_FLAG },

        [nl80211_attrs.NL80211_ATTR_IFTYPE] = NLA_POLICY_MAX(NLA_U32, NL80211_IFTYPE_MAX),
        [nl80211_attrs.NL80211_ATTR_IFINDEX] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_IFNAME] = {  .type = NLA_NUL_STRING,  .len = IFNAMSIZ-1 },

        [nl80211_attrs.NL80211_ATTR_MAC] = NLA_POLICY_EXACT_LEN_WARN(ETH_ALEN),
        [nl80211_attrs.NL80211_ATTR_PREV_BSSID] = NLA_POLICY_EXACT_LEN_WARN(ETH_ALEN),

        [nl80211_attrs.NL80211_ATTR_KEY] = {  .type = NLA_NESTED, },
        [nl80211_attrs.NL80211_ATTR_KEY_DATA] = { .type = NLA_BINARY, .len = WLAN_MAX_KEY_LEN },
        [nl80211_attrs.NL80211_ATTR_KEY_IDX] = NLA_POLICY_MAX(NLA_U8, 7),
        [nl80211_attrs.NL80211_ATTR_KEY_CIPHER] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_KEY_DEFAULT] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_KEY_SEQ] = {  .type = NLA_BINARY,  .len = 16 },
        [nl80211_attrs.NL80211_ATTR_KEY_TYPE] = NLA_POLICY_MAX(NLA_U32, NUM_NL80211_KEYTYPES),

        [nl80211_attrs.NL80211_ATTR_BEACON_INTERVAL] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_DTIM_PERIOD] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_BEACON_HEAD] = NLA_POLICY_VALIDATE_FN(NLA_BINARY, validate_beacon_head, IEEE80211_MAX_DATA_LEN),
        [nl80211_attrs.NL80211_ATTR_BEACON_TAIL] = NLA_POLICY_VALIDATE_FN(NLA_BINARY, validate_ie_attr, IEEE80211_MAX_DATA_LEN),
        [nl80211_attrs.NL80211_ATTR_STA_AID] = NLA_POLICY_RANGE(NLA_U16, 1, IEEE80211_MAX_AID),
        [nl80211_attrs.NL80211_ATTR_STA_FLAGS] = {  .type = NLA_NESTED },
        [nl80211_attrs.NL80211_ATTR_STA_LISTEN_INTERVAL] = {  .type = NLA_U16 },
        [nl80211_attrs.NL80211_ATTR_STA_SUPPORTED_RATES] = { .type = NLA_BINARY, .len = NL80211_MAX_SUPP_RATES },
        [nl80211_attrs.NL80211_ATTR_STA_PLINK_ACTION] = NLA_POLICY_MAX(NLA_U8, NUM_NL80211_PLINK_ACTIONS - 1),
        [nl80211_attrs.NL80211_ATTR_STA_TX_POWER_SETTING] = NLA_POLICY_RANGE(NLA_U8, NL80211_TX_POWER_AUTOMATIC, NL80211_TX_POWER_FIXED),
        [nl80211_attrs.NL80211_ATTR_STA_TX_POWER] = {  .type = NLA_S16 },
        [nl80211_attrs.NL80211_ATTR_STA_VLAN] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_MNTR_FLAGS] = { /* NLA_NESTED can't be empty */ },
        [nl80211_attrs.NL80211_ATTR_MESH_ID] = { .type = NLA_BINARY, .len = IEEE80211_MAX_MESH_ID_LEN },
        [nl80211_attrs.NL80211_ATTR_MPATH_NEXT_HOP] = NLA_POLICY_ETH_ADDR_COMPAT,

        /* allow 3 for NUL-termination, we used to declare this NLA_STRING */
        [nl80211_attrs.NL80211_ATTR_REG_ALPHA2] = NLA_POLICY_RANGE(NLA_BINARY, 2, 3),
        [nl80211_attrs.NL80211_ATTR_REG_RULES] = {  .type = NLA_NESTED },

        [nl80211_attrs.NL80211_ATTR_BSS_CTS_PROT] = {  .type = NLA_U8 },
        [nl80211_attrs.NL80211_ATTR_BSS_SHORT_PREAMBLE] = {  .type = NLA_U8 },
        [nl80211_attrs.NL80211_ATTR_BSS_SHORT_SLOT_TIME] = {  .type = NLA_U8 },
        [nl80211_attrs.NL80211_ATTR_BSS_BASIC_RATES] = { .type = NLA_BINARY, .len = NL80211_MAX_SUPP_RATES },
        [nl80211_attrs.NL80211_ATTR_BSS_HT_OPMODE] = {  .type = NLA_U16 },

        [nl80211_attrs.NL80211_ATTR_MESH_CONFIG] = {  .type = NLA_NESTED },
        [nl80211_attrs.NL80211_ATTR_SUPPORT_MESH_AUTH] = {  .type = NLA_FLAG },

        [nl80211_attrs.NL80211_ATTR_HT_CAPABILITY] = NLA_POLICY_EXACT_LEN_WARN(NL80211_HT_CAPABILITY_LEN),

        [nl80211_attrs.NL80211_ATTR_MGMT_SUBTYPE] = {  .type = NLA_U8 },
        [nl80211_attrs.NL80211_ATTR_IE] = NLA_POLICY_VALIDATE_FN(NLA_BINARY, validate_ie_attr, IEEE80211_MAX_DATA_LEN),
        [nl80211_attrs.NL80211_ATTR_SCAN_FREQUENCIES] = {  .type = NLA_NESTED },
        [nl80211_attrs.NL80211_ATTR_SCAN_SSIDS] = {  .type = NLA_NESTED },

        [nl80211_attrs.NL80211_ATTR_SSID] = { .type = NLA_BINARY, .len = IEEE80211_MAX_SSID_LEN },
        [nl80211_attrs.NL80211_ATTR_AUTH_TYPE] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_REASON_CODE] = {  .type = NLA_U16 },
        [nl80211_attrs.NL80211_ATTR_FREQ_FIXED] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_TIMED_OUT] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_USE_MFP] = NLA_POLICY_RANGE(NLA_U32, NL80211_MFP_NO, NL80211_MFP_OPTIONAL),
        [nl80211_attrs.NL80211_ATTR_STA_FLAGS2] = NLA_POLICY_EXACT_LEN_WARN(sizeof(struct nl80211_sta_flag_update)),
        [nl80211_attrs.NL80211_ATTR_CONTROL_PORT] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_CONTROL_PORT_ETHERTYPE] = {  .type = NLA_U16 },
        [nl80211_attrs.NL80211_ATTR_CONTROL_PORT_NO_ENCRYPT] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_CONTROL_PORT_OVER_NL80211] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_PRIVACY] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_STATUS_CODE] = {  .type = NLA_U16 },
        [nl80211_attrs.NL80211_ATTR_CIPHER_SUITE_GROUP] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_WPA_VERSIONS] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_PID] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_4ADDR] = {  .type = NLA_U8 },
        [nl80211_attrs.NL80211_ATTR_PMKID] = NLA_POLICY_EXACT_LEN_WARN(WLAN_PMKID_LEN),
        [nl80211_attrs.NL80211_ATTR_DURATION] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_COOKIE] = {  .type = NLA_U64 },
        [nl80211_attrs.NL80211_ATTR_TX_RATES] = {  .type = NLA_NESTED },
        [nl80211_attrs.NL80211_ATTR_FRAME] = { .type = NLA_BINARY, .len = IEEE80211_MAX_DATA_LEN },
        [nl80211_attrs.NL80211_ATTR_FRAME_MATCH] = {  .type = NLA_BINARY, },
        [nl80211_attrs.NL80211_ATTR_PS_STATE] = NLA_POLICY_RANGE(NLA_U32, NL80211_PS_DISABLED, NL80211_PS_ENABLED),
        [nl80211_attrs.NL80211_ATTR_CQM] = {  .type = NLA_NESTED, },
        [nl80211_attrs.NL80211_ATTR_LOCAL_STATE_CHANGE] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_AP_ISOLATE] = {  .type = NLA_U8 },
        [nl80211_attrs.NL80211_ATTR_WIPHY_TX_POWER_SETTING] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_WIPHY_TX_POWER_LEVEL] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_FRAME_TYPE] = {  .type = NLA_U16 },
        [nl80211_attrs.NL80211_ATTR_WIPHY_ANTENNA_TX] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_WIPHY_ANTENNA_RX] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_MCAST_RATE] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_OFFCHANNEL_TX_OK] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_KEY_DEFAULT_TYPES] = {  .type = NLA_NESTED },
        [nl80211_attrs.NL80211_ATTR_WOWLAN_TRIGGERS] = {  .type = NLA_NESTED },
        [nl80211_attrs.NL80211_ATTR_STA_PLINK_STATE] = NLA_POLICY_MAX(NLA_U8, NUM_NL80211_PLINK_STATES - 1),
        [nl80211_attrs.NL80211_ATTR_MEASUREMENT_DURATION] = {  .type = NLA_U16 },
        [nl80211_attrs.NL80211_ATTR_MEASUREMENT_DURATION_MANDATORY] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_MESH_PEER_AID] = NLA_POLICY_RANGE(NLA_U16, 1, IEEE80211_MAX_AID),
        [nl80211_attrs.NL80211_ATTR_SCHED_SCAN_INTERVAL] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_REKEY_DATA] = {  .type = NLA_NESTED },
        [nl80211_attrs.NL80211_ATTR_SCAN_SUPP_RATES] = {  .type = NLA_NESTED },
        [nl80211_attrs.NL80211_ATTR_HIDDEN_SSID] = NLA_POLICY_RANGE(NLA_U32, NL80211_HIDDEN_SSID_NOT_IN_USE, NL80211_HIDDEN_SSID_ZERO_CONTENTS),
        [nl80211_attrs.NL80211_ATTR_IE_PROBE_RESP] = NLA_POLICY_VALIDATE_FN(NLA_BINARY, validate_ie_attr, IEEE80211_MAX_DATA_LEN),
        [nl80211_attrs.NL80211_ATTR_IE_ASSOC_RESP] = NLA_POLICY_VALIDATE_FN(NLA_BINARY, validate_ie_attr, IEEE80211_MAX_DATA_LEN),
        [nl80211_attrs.NL80211_ATTR_ROAM_SUPPORT] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_STA_WME] = NLA_POLICY_NESTED(nl80211_sta_wme_policy),
        [nl80211_attrs.NL80211_ATTR_SCHED_SCAN_MATCH] = {  .type = NLA_NESTED },
        [nl80211_attrs.NL80211_ATTR_TX_NO_CCK_RATE] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_TDLS_ACTION] = {  .type = NLA_U8 },
        [nl80211_attrs.NL80211_ATTR_TDLS_DIALOG_TOKEN] = {  .type = NLA_U8 },
        [nl80211_attrs.NL80211_ATTR_TDLS_OPERATION] = {  .type = NLA_U8 },
        [nl80211_attrs.NL80211_ATTR_TDLS_SUPPORT] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_TDLS_EXTERNAL_SETUP] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_TDLS_INITIATOR] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_DONT_WAIT_FOR_ACK] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_PROBE_RESP] = { .type = NLA_BINARY, .len = IEEE80211_MAX_DATA_LEN },
        [nl80211_attrs.NL80211_ATTR_DFS_REGION] = {  .type = NLA_U8 },
        [nl80211_attrs.NL80211_ATTR_DISABLE_HT] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_HT_CAPABILITY_MASK] = { .len = NL80211_HT_CAPABILITY_LEN },
        [nl80211_attrs.NL80211_ATTR_NOACK_MAP] = {  .type = NLA_U16 },
        [nl80211_attrs.NL80211_ATTR_INACTIVITY_TIMEOUT] = {  .type = NLA_U16 },
        [nl80211_attrs.NL80211_ATTR_BG_SCAN_PERIOD] = {  .type = NLA_U16 },
        [nl80211_attrs.NL80211_ATTR_WDEV] = {  .type = NLA_U64 },
        [nl80211_attrs.NL80211_ATTR_USER_REG_HINT_TYPE] = {  .type = NLA_U32 },

        /* need to include at least Auth Transaction and Status Code */
        [nl80211_attrs.NL80211_ATTR_AUTH_DATA] = NLA_POLICY_MIN_LEN(4),

        [nl80211_attrs.NL80211_ATTR_VHT_CAPABILITY] = NLA_POLICY_EXACT_LEN_WARN(NL80211_VHT_CAPABILITY_LEN),
        [nl80211_attrs.NL80211_ATTR_SCAN_FLAGS] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_P2P_CTWINDOW] = NLA_POLICY_MAX(NLA_U8, 127),
        [nl80211_attrs.NL80211_ATTR_P2P_OPPPS] = NLA_POLICY_MAX(NLA_U8, 1),
        [nl80211_attrs.NL80211_ATTR_LOCAL_MESH_POWER_MODE] = NLA_POLICY_RANGE(NLA_U32, NL80211_MESH_POWER_UNKNOWN + 1, NL80211_MESH_POWER_MAX),
        [nl80211_attrs.NL80211_ATTR_ACL_POLICY] = { . type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_MAC_ADDRS] = {  .type = NLA_NESTED },
        [nl80211_attrs.NL80211_ATTR_STA_CAPABILITY] = {  .type = NLA_U16 },
        [nl80211_attrs.NL80211_ATTR_STA_EXT_CAPABILITY] = {  .type = NLA_BINARY, },
        [nl80211_attrs.NL80211_ATTR_SPLIT_WIPHY_DUMP] = {  .type = NLA_FLAG, },
        [nl80211_attrs.NL80211_ATTR_DISABLE_VHT] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_VHT_CAPABILITY_MASK] = { .len = NL80211_VHT_CAPABILITY_LEN, },
        [nl80211_attrs.NL80211_ATTR_MDID] = {  .type = NLA_U16 },
        [nl80211_attrs.NL80211_ATTR_IE_RIC] = { .type = NLA_BINARY, .len = IEEE80211_MAX_DATA_LEN },
        [nl80211_attrs.NL80211_ATTR_CRIT_PROT_ID] = {  .type = NLA_U16 },
        [nl80211_attrs.NL80211_ATTR_MAX_CRIT_PROT_DURATION] = NLA_POLICY_MAX(NLA_U16, NL80211_CRIT_PROTO_MAX_DURATION),
        [nl80211_attrs.NL80211_ATTR_PEER_AID] = NLA_POLICY_RANGE(NLA_U16, 1, IEEE80211_MAX_AID),
        [nl80211_attrs.NL80211_ATTR_CH_SWITCH_COUNT] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_CH_SWITCH_BLOCK_TX] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_CSA_IES] = {  .type = NLA_NESTED },
        [nl80211_attrs.NL80211_ATTR_CNTDWN_OFFS_BEACON] = {  .type = NLA_BINARY },
        [nl80211_attrs.NL80211_ATTR_CNTDWN_OFFS_PRESP] = {  .type = NLA_BINARY },
        [nl80211_attrs.NL80211_ATTR_STA_SUPPORTED_CHANNELS] = NLA_POLICY_MIN_LEN(2),
        /*
         * The value of the Length field of the Supported Operating
         * Classes element is between 2 and 253.
         */
        [nl80211_attrs.NL80211_ATTR_STA_SUPPORTED_OPER_CLASSES] = NLA_POLICY_RANGE(NLA_BINARY, 2, 253),
        [nl80211_attrs.NL80211_ATTR_HANDLE_DFS] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_OPMODE_NOTIF] = {  .type = NLA_U8 },
        [nl80211_attrs.NL80211_ATTR_VENDOR_ID] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_VENDOR_SUBCMD] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_VENDOR_DATA] = {  .type = NLA_BINARY },
        [nl80211_attrs.NL80211_ATTR_QOS_MAP] = NLA_POLICY_RANGE(NLA_BINARY, IEEE80211_QOS_MAP_LEN_MIN, IEEE80211_QOS_MAP_LEN_MAX),
        [nl80211_attrs.NL80211_ATTR_MAC_HINT] = NLA_POLICY_EXACT_LEN_WARN(ETH_ALEN),
        [nl80211_attrs.NL80211_ATTR_WIPHY_FREQ_HINT] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_TDLS_PEER_CAPABILITY] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_SOCKET_OWNER] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_CSA_C_OFFSETS_TX] = {  .type = NLA_BINARY },
        [nl80211_attrs.NL80211_ATTR_USE_RRM] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_TSID] = NLA_POLICY_MAX(NLA_U8, IEEE80211_NUM_TIDS - 1),
        [nl80211_attrs.NL80211_ATTR_USER_PRIO] = NLA_POLICY_MAX(NLA_U8, IEEE80211_NUM_UPS - 1),
        [nl80211_attrs.NL80211_ATTR_ADMITTED_TIME] = {  .type = NLA_U16 },
        [nl80211_attrs.NL80211_ATTR_SMPS_MODE] = {  .type = NLA_U8 },
        [nl80211_attrs.NL80211_ATTR_OPER_CLASS] = {  .type = NLA_U8 },
        [nl80211_attrs.NL80211_ATTR_MAC_MASK] = NLA_POLICY_EXACT_LEN_WARN(ETH_ALEN),
        [nl80211_attrs.NL80211_ATTR_WIPHY_SELF_MANAGED_REG] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_NETNS_FD] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_SCHED_SCAN_DELAY] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_REG_INDOOR] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_PBSS] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_BSS_SELECT] = {  .type = NLA_NESTED },
        [nl80211_attrs.NL80211_ATTR_STA_SUPPORT_P2P_PS] = NLA_POLICY_MAX(NLA_U8, NUM_NL80211_P2P_PS_STATUS - 1),
        [nl80211_attrs.NL80211_ATTR_MU_MIMO_GROUP_DATA] = { .len = VHT_MUMIMO_GROUPS_DATA_LEN },
        [nl80211_attrs.NL80211_ATTR_MU_MIMO_FOLLOW_MAC_ADDR] = NLA_POLICY_EXACT_LEN_WARN(ETH_ALEN),
        [nl80211_attrs.NL80211_ATTR_NAN_MASTER_PREF] = NLA_POLICY_MIN(NLA_U8, 1),
        [nl80211_attrs.NL80211_ATTR_BANDS] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_NAN_FUNC] = {  .type = NLA_NESTED },
        [nl80211_attrs.NL80211_ATTR_FILS_KEK] = { .type = NLA_BINARY, .len = FILS_MAX_KEK_LEN },
        [nl80211_attrs.NL80211_ATTR_FILS_NONCES] = NLA_POLICY_EXACT_LEN_WARN(2 * FILS_NONCE_LEN),
        [nl80211_attrs.NL80211_ATTR_MULTICAST_TO_UNICAST_ENABLED] = {  .type = NLA_FLAG, },
        [nl80211_attrs.NL80211_ATTR_BSSID] = NLA_POLICY_EXACT_LEN_WARN(ETH_ALEN),
        [nl80211_attrs.NL80211_ATTR_SCHED_SCAN_RELATIVE_RSSI] = {  .type = NLA_S8 },
        [nl80211_attrs.NL80211_ATTR_SCHED_SCAN_RSSI_ADJUST] = { .len = sizeof(struct nl80211_bss_select_rssi_adjust) },
        [nl80211_attrs.NL80211_ATTR_TIMEOUT_REASON] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_FILS_ERP_USERNAME] = { .type = NLA_BINARY, .len = FILS_ERP_MAX_USERNAME_LEN },
        [nl80211_attrs.NL80211_ATTR_FILS_ERP_REALM] = { .type = NLA_BINARY, .len = FILS_ERP_MAX_REALM_LEN },
        [nl80211_attrs.NL80211_ATTR_FILS_ERP_NEXT_SEQ_NUM] = {  .type = NLA_U16 },
        [nl80211_attrs.NL80211_ATTR_FILS_ERP_RRK] = { .type = NLA_BINARY, .len = FILS_ERP_MAX_RRK_LEN },
        [nl80211_attrs.NL80211_ATTR_FILS_CACHE_ID] = NLA_POLICY_EXACT_LEN_WARN(2),
        [nl80211_attrs.NL80211_ATTR_PMK] = {  .type = NLA_BINARY,  .len = PMK_MAX_LEN },
        [nl80211_attrs.NL80211_ATTR_PMKR0_NAME] = NLA_POLICY_EXACT_LEN(WLAN_PMK_NAME_LEN),
        [nl80211_attrs.NL80211_ATTR_SCHED_SCAN_MULTI] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_EXTERNAL_AUTH_SUPPORT] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_TXQ_LIMIT] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_TXQ_MEMORY_LIMIT] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_TXQ_QUANTUM] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_HE_CAPABILITY] = NLA_POLICY_VALIDATE_FN(NLA_BINARY, validate_he_capa, NL80211_HE_MAX_CAPABILITY_LEN),
        [nl80211_attrs.NL80211_ATTR_FTM_RESPONDER] = NLA_POLICY_NESTED(nl80211_ftm_responder_policy),
        [nl80211_attrs.NL80211_ATTR_TIMEOUT] = NLA_POLICY_MIN(NLA_U32, 1),
        [nl80211_attrs.NL80211_ATTR_PEER_MEASUREMENTS] = NLA_POLICY_NESTED(nl80211_pmsr_attr_policy),
        [nl80211_attrs.NL80211_ATTR_AIRTIME_WEIGHT] = NLA_POLICY_MIN(NLA_U16, 1),
        [nl80211_attrs.NL80211_ATTR_SAE_PASSWORD] = { .type = NLA_BINARY, .len = SAE_PASSWORD_MAX_LEN },
        [nl80211_attrs.NL80211_ATTR_TWT_RESPONDER] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_HE_OBSS_PD] = NLA_POLICY_NESTED(he_obss_pd_policy),
        [nl80211_attrs.NL80211_ATTR_VLAN_ID] = NLA_POLICY_RANGE(NLA_U16, 1, VLAN_N_VID - 2),
        [nl80211_attrs.NL80211_ATTR_HE_BSS_COLOR] = NLA_POLICY_NESTED(he_bss_color_policy),
        [nl80211_attrs.NL80211_ATTR_TID_CONFIG] = NLA_POLICY_NESTED_ARRAY(nl80211_tid_config_attr_policy),
        [nl80211_attrs.NL80211_ATTR_CONTROL_PORT_NO_PREAUTH] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_PMK_LIFETIME] = NLA_POLICY_MIN(NLA_U32, 1),
        [nl80211_attrs.NL80211_ATTR_PMK_REAUTH_THRESHOLD] = NLA_POLICY_RANGE(NLA_U8, 1, 100),
        [nl80211_attrs.NL80211_ATTR_RECEIVE_MULTICAST] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_WIPHY_FREQ_OFFSET] = NLA_POLICY_RANGE(NLA_U32, 0, 999),
        [nl80211_attrs.NL80211_ATTR_SCAN_FREQ_KHZ] = {  .type = NLA_NESTED },
        [nl80211_attrs.NL80211_ATTR_HE_6GHZ_CAPABILITY] = NLA_POLICY_EXACT_LEN(sizeof(struct ieee80211_he_6ghz_capa)),
        [nl80211_attrs.NL80211_ATTR_FILS_DISCOVERY] = NLA_POLICY_NESTED(nl80211_fils_discovery_policy),
        [nl80211_attrs.NL80211_ATTR_UNSOL_BCAST_PROBE_RESP] = NLA_POLICY_NESTED(nl80211_unsol_bcast_probe_resp_policy),
        [nl80211_attrs.NL80211_ATTR_S1G_CAPABILITY] = NLA_POLICY_EXACT_LEN(IEEE80211_S1G_CAPABILITY_LEN),
        [nl80211_attrs.NL80211_ATTR_S1G_CAPABILITY_MASK] = NLA_POLICY_EXACT_LEN(IEEE80211_S1G_CAPABILITY_LEN),
        [nl80211_attrs.NL80211_ATTR_SAE_PWE] = NLA_POLICY_RANGE(NLA_U8, NL80211_SAE_PWE_HUNT_AND_PECK, NL80211_SAE_PWE_BOTH),
        [nl80211_attrs.NL80211_ATTR_RECONNECT_REQUESTED] = {  .type = NLA_REJECT },
        [nl80211_attrs.NL80211_ATTR_SAR_SPEC] = NLA_POLICY_NESTED(sar_policy),
        [nl80211_attrs.NL80211_ATTR_DISABLE_HE] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_OBSS_COLOR_BITMAP] = {  .type = NLA_U64 },
        [nl80211_attrs.NL80211_ATTR_COLOR_CHANGE_COUNT] = {  .type = NLA_U8 },
        [nl80211_attrs.NL80211_ATTR_COLOR_CHANGE_COLOR] = {  .type = NLA_U8 },
        [nl80211_attrs.NL80211_ATTR_COLOR_CHANGE_ELEMS] = NLA_POLICY_NESTED(nl80211_policy),
        [nl80211_attrs.NL80211_ATTR_MBSSID_CONFIG] = NLA_POLICY_NESTED(nl80211_mbssid_config_policy),
        [nl80211_attrs.NL80211_ATTR_MBSSID_ELEMS] = {  .type = NLA_NESTED },
        [nl80211_attrs.NL80211_ATTR_RADAR_BACKGROUND] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_AP_SETTINGS_FLAGS] = {  .type = NLA_U32 },
        [nl80211_attrs.NL80211_ATTR_EHT_CAPABILITY] = NLA_POLICY_RANGE(NLA_BINARY, NL80211_EHT_MIN_CAPABILITY_LEN, NL80211_EHT_MAX_CAPABILITY_LEN),
        [nl80211_attrs.NL80211_ATTR_DISABLE_EHT] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_MLO_LINKS] = NLA_POLICY_NESTED_ARRAY(nl80211_policy),
        [nl80211_attrs.NL80211_ATTR_MLO_LINK_ID] = NLA_POLICY_RANGE(NLA_U8, 0, IEEE80211_MLD_MAX_NUM_LINKS),
        [nl80211_attrs.NL80211_ATTR_MLD_ADDR] = NLA_POLICY_EXACT_LEN(ETH_ALEN),
        [nl80211_attrs.NL80211_ATTR_MLO_SUPPORT] = {  .type = NLA_FLAG },
        [nl80211_attrs.NL80211_ATTR_MAX_NUM_AKM_SUITES] = {  .type = NLA_REJECT },
        [nl80211_attrs.NL80211_ATTR_PUNCT_BITMAP] = NLA_POLICY_FULL_RANGE(NLA_U32, &nl80211_punct_bitmap_range),
    };
}
